---
const { id } = Astro.params;

import Layout from "@/layouts/clients/Layout.astro";
import View from "@/src/views/clients/servers/Addons.astro";
import { clients } from "@/database/index";
import profile from "@/utils/profile";
import { getLangFromUrl, useTranslatedPath } from "@/i18n/utils";

const lang = getLangFromUrl(Astro.url);
const translatePath = useTranslatedPath(lang);
const cookie: string = `${Astro.cookies.get("_SECURE_SESSION_TOKEN_")?.value}`;
const c = profile(cookie);

if (c.success === true && c.clientId !== null) {
  const client = await clients
    .findOneBy({ id: c.clientId })
    .then((client) => client?.email === c.email);
  if (!client) {
    return Astro.redirect("/");
  }
}
---

<Layout
    title="Addons"
    route="client.servers.index"
    items={[
        { title: "Dashboard", url: translatePath("/client") },
        { title: "Servers", url: translatePath("/client/servers") },
        { title: `Server #${id}`, url: translatePath(`/client/servers/${id}`) },
    ]}
>
    <View />
</Layout>
